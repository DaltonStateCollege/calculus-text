\section{Triple Integration with Spherical Coordinates}\label{sec:spherical}

In the previous section, we explored how cylindrical coordinates can make it easier to compute certain triple integrals.  Other such integrals are more naturally handled using \emph{spherical} coordinates.
Objects bounded by spheres or conefs are more easily described using this coordinate system.  The Earth, for example, is a solid sphere (or near enough). On its surface we use two coordinates - latitude and longitude. To dig inward or fly outward, there is a third coordinate, the distance $\rho$ from the center. This Greek letter \textit{rho} ($\rho$) replaces radius $r$ to avoid confusion with cylindrical coordinates. Where $r$ is measured from the $z$-axis, $\rho$ is measured directly from the origin. Thus for any point $(x,y,z)$,
$$\rho^2 = x^2 + y^2 + z^2$$
which is the square of the distance between the origin and the point. The angle $\theta$ is the same as in cylindrical coordinates, and it goes from $0$ to $2\pi$ on a full sphere with $\theta = 0$ pointing in the direction of the positive $x$-axis. It is the longitude, which increases as you travel east around the Equator. The angle $\varphi$ is new, however. It equals $0$ at the North Pole and $\pi$ (not $2\pi$) at the South Pole. It is measured down from the $z$-axis. The Equator, for example, has a latitude of $0$ degrees but has angle $\varphi = \frac{\pi}{2}$ instead. See Figure \ref{fig:sphericalintro}.  (The angle $\varphi$ is $\frac{\pi}{2}$ minus the latitude (in radians) on Earth.)

\mfigurethree{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
3Droll=0,
3Dortho=0.0045,
3Dc2c=0.6936245560646057 0.5807817578315735 0.4261191189289093,
3Dcoo=-15.555180549621582 -9.786354064941406 35.21320343017578,
3Droo=150,
3Dlights=Headlamp,add3Djscript=asylabels.js}{width=150pt}{.5}{Illustrating the principles behind spherical coordinates.}{fig:sphericalintro}{figures/figsphericalintro_3D} 

The spherical coordinates of a point $(x,y,z)$ are given by the ordered triple $(\rho, \theta, \varphi)$ where $\rho$, $\theta$, and $\varphi$ can be restricted to $\rho \geq 0$, $0 \leq \theta \leq 2\pi$, and $0 \leq \varphi \leq \pi$.  The relationship between spherical and Cartesian coordinates is illustrated by Figure \ref{fig:sphericalintro}.  From the triangles, we have
$$z = \rho \cos\varphi \text{ and } r = \rho \sin\varphi$$
But we know that $x = r \cos\theta$ and $y = r \sin\theta$ from before, so we end up with the following conversion equations.\\

\keyidea{idea:sphericalcart_conversion}{Converting between spherical and Cartesian coordinates}{
Given a point $(\rho, \theta, \varphi)$ in spherical coordinates, its Cartesian coordinates are
$$x = \rho \sin\varphi \cos\theta, \: y = \rho \sin\varphi \sin\theta, \: z = \rho \cos\varphi.$$
(Using the spherical-to-cylindrical conversion $r=\rho\sin\theta$ can help one remember the $x$ and $y$ formulas above.)\\

Given a point $(x,y,z)$ in Cartesian coordinates, we use
\begin{itemize}
\item $\rho^2 = x^2 + y^2 + z^2$
\item $\tan\theta = \dfrac{y}{x}$ for $x\not=0$
\item $\cos\varphi = \dfrac{z}{\rho}$ except at the origin (where $\varphi$ can have any value)
\end{itemize}
to convert to spherical coordinates.\\
}



\mnote{.75}{\textbf{Note:} The role of $\theta$ and $\varphi$ in spherical coordinates differs between mathematicians and physicists. When reading about physics in spherical coordinates, be careful to note how that particular author uses these variables and recognize that these identities will may no longer be valid.
}

\example{ex_spherical4}{Converting between rectangular and spherical coordinates}
{Convert the rectangular point $(-2,2,1)$ to spherical coordinates, and convert the spherical point $(6,\pi/3,\pi/2)$ to rectangular and cylindrical coordinates.
}
{This rectangular point is the same as used in Example \ref{ex_cylindrical4}. Using Key Idea \ref{idea:sphericalcart_conversion}, we find $\rho = \sqrt{(-2)^2+2^2+1^2} = 3$. Using the same logic as in Example \ref{ex_cylindrical4}, we find $\theta = 3\pi/4$. Finally, $\cos\varphi = 1/3$, giving $\varphi = \cos^{-1}(1/3) \approx 1.23$, or about $70.53^\circ$. Thus the spherical coordinates are approximately $(3,3\pi/4,1.23)$.

Converting the spherical point $(6,\pi/3,\pi/2)$ to rectangular, we have $x = 6\sin(\pi/2)\cos(\pi/3) = 3$, $y = 6\sin(\pi/2)\sin(\pi/3) = 3\sqrt{3}$ and $z = 6\cos(\pi/2) = 0$. Thus the rectangular coordinates are $(3,3\sqrt{3},0)$.

To convert this spherical point to cylindrical, we have $r = 6\sin(\pi/2) = 6$, $\theta = \pi/3$ and $z = 6\cos(\pi/2) =0$, giving the cylindrical point $(6,\pi/3,0)$.
}\\

\example{ex_spherical1}{Canonical surfaces in spherical coordinates}
{Describe the surfaces $\rho=1$, $\theta = \pi/3$ and $\varphi = \pi/6$, given in spherical coordinates.
}
{The equation $\rho = 1$ describes all points in space that are 1 unit away from the origin: this is the sphere of radius 1, centered at the origin.

The equation $\theta = \pi/3$ describes the same surface in spherical coordinates as it does in cylindrical coordinates: beginning with the line $\theta = \pi/3$ in the $x$-$y$ plane as given by polar coordinates, extend the line parallel to the $z$-axis, forming a plane.

The equation $\varphi=\pi/6$ describes all points $P$ in space where the ray from the origin to $P$ makes an angle of $\pi/6$ with the positive $z$-axis. This describes a cone, with the positive $z$-axis its axis of symmetry, with point at the origin.
\mfigurethree{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
3Droll=0,
3Dortho=0.004559914115816355,
3Dc2c=0.8784526586532593 0.3397093713283539 0.3360334038734436,
3Dcoo=7.126433849334717 10.647956848144531 4.059844017028809,
3Droo=300,
3Dlights=Headlamp,add3Djscript=asylabels.js}{width=150pt}{.78}{Graphing the canonical surfaces in spherical coordinates from Example \ref{ex_spherical1}.}{fig:spherical1}{figures/figspherical1_3D} 

All three surfaces are graphed in Figure \ref{fig:spherical1}. Note how their intersection uniquely defines the point $P=(1,\pi/3,\pi/6)$.
}\\

Spherical coordinates are useful when describing certain domains in space, allowing us to evaluate triple integrals over these domains more easily than if we used rectangular coordinates or cylindrical coordinates. The crux of setting up a triple integral in spherical coordinates is appropriately describing the ``small amount of volume,'' $dV$, used in the integral.

Considering Figure \ref{fig:sphericalwedge}, we can make a small ``spherical wedge'' by varying $\rho$, $\theta$ and $\varphi$ each a small amount, $\Delta\rho$, $\Delta\theta$ and $\Delta\varphi$, respectively. This wedge is approximately a rectangular solid when the change in each coordinate is small, giving a volume of about
$$\Delta V \approx \Delta\rho\ \times\ \rho\Delta\varphi\ \times\ \rho\sin(\varphi)\Delta\theta.$$
\mfigurethree{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
3Droll=0,
3Dortho=0.004123700316995382,
3Dc2c=0.8697938919067383 0.43597298860549927 0.23105460405349731,
3Dcoo=-19.780941009521484 32.02916717529297 43.93011474609375,
3Droo=300.000013020833,
3Dlights=Headlamp,add3Djscript=asylabels.js}{width=150pt}{.5}{Approximating the volume of a standard region in space using spherical coordinates.}{fig:sphericalwedge}{figures/figsphericalwedge_3D} 

Given a region $D$ in space, we can approximate the volume of $D$ with many such wedges. As the size of each of $\Delta\rho$, $\Delta\theta$ and $\Delta\varphi$ goes to zero, the number of wedges increases to infinity and the volume of $D$ is more accurately approximated, giving
$$dV = d\rho\ \times\ \rho\ d\varphi\ \times\ \rho\sin(\varphi)d\theta = \rho^2\sin(\varphi)\ d\rho\ d\theta\ d\varphi.$$

Again, this development of $dV$ should sound reasonable, and the following theorem states it is the appropriate manner by which triple integrals are to be evaluated in spherical coordinates.
\mnote{.29}{\textbf{Note:} It is generally most intuitive to evaluate the triple integral in Theorem \ref{thm:triple_int_spherical} by integrating with respect to $\rho$ first; it often does not matter whether we next integrate with respect to $\theta$ or $\varphi$. Different texts present different standard orders, some preferring $d\varphi\ d\theta$ instead of $d\theta\ d\varphi$. As the bounds for these variables are usually constants in practice, it generally is a matter of preference.
}
%\enlargethispage{2\baselineskip}

\theorem{thm:triple_int_spherical}{Triple Integration in Spherical Coordinates}
{Let $w=h(\rho,\theta,\varphi)$ be a continuous function on a closed, bounded region $D$ in space, bounded in spherical coordinates by $\alpha_1 \leq \varphi \leq \alpha_2$, $\beta_1 \leq \theta \leq \beta_2$ and $f_1(\theta,\varphi) \leq \rho \leq f_2(\theta,\varphi)$. Then \index{integration!with spherical coordinates}
$$\iiint_D h(\rho,\theta,\varphi)\ dV = \int_{\alpha_1}^{\alpha_2}\int_{\beta_1}^{\beta_2}\int_{f_1(\theta,\varphi)}^{f_2(\theta,\varphi)} h(\rho,\theta,\varphi) \rho^2\sin(\varphi)\ d\rho\ d\theta\ d\varphi.$$
}

\example{ex_spherical2}{Establishing the volume of a sphere}
{Let $D$ be the region in space bounded by the sphere, centered at the origin, of radius $r$. Use a triple integral in spherical coordinates to find the volume $V$ of $D$.
}
{The sphere of radius $r$, centered at the origin, has equation $\rho = r$. To obtain the full sphere, the bounds on $\theta$ and $\varphi$ are $0\leq \theta \leq 2\pi$ and $0 \leq \varphi \leq \pi$. This leads us to:
\begin{align*}
V &= \iiint_D\ dV\\
	&= \int_0^{\pi}\int_0^{2\pi}\int_0^r\big(\rho^2\sin(\varphi)\big)\ d\rho\ d\theta\ d\varphi\\
	&= \int_0^\pi\int_0^{2\pi}\left(\frac13\rho^3\sin(\varphi)\Big|_0^r\right)\ d\theta\ d\varphi\\
	&= \int_0^\pi\int_0^{2\pi} \left(\frac13r^3\sin(\varphi)\right)\ d\theta\ d\varphi\\
	&= \int_0^\pi \left(\frac{2\pi}3r^3\sin(\varphi)\right)\ d\varphi\\
	&= \left.\left(-\frac{2\pi}3r^3\cos(\varphi)\right)\right|_0^{\pi}\\
	&= \frac{4\pi}3r^3,
\end{align*}
the familiar formula for the volume of a sphere. Note how the integration steps were easy, not using square--roots nor integration steps such as Substitution.
}\\

\example{ex_volume04}{Evaluating an integral using spherical coordinates}{Evaluate the integral
$$\iiint_D x^2 + y^2 + z^2 \: dV$$
where $D$ is the solid that lies above the cone $z = \sqrt{x^2 + y^2}$ but below the sphere of radius $\frac{1}{2}$ centered at $\left( 0,0,\frac{1}{2}\right)$.}
{The cone $z = \sqrt{x^2 + y^2}$ is the cone pointing upward from the origin at an angle of $\frac{\pi}{4}$ from the $xy$-plane. The solid $D$ therefore consists of a half-spherical top with a conical bottom, with the point of the cone at the origin, meeting the spherical top at the horizontal equator of the sphere.\\

To describe this solid in spherical coordinates, note that the sphere of radius $\frac{1}{2}$ centered at the point $\left( 0,0,\frac{1}{2}\right)$ can be written as $$x^2 + y^2 + \left( z - \frac{1}{2}\right)^2 = \frac{1}{4}$$ which is equivalent to $x^2 + y^2 + z^2 = z$. In spherical coordinates, this says $\rho^2 = \rho \: \cos\varphi$, or $\rho = \cos\varphi$.  As for the cone, the equation $\varphi = \frac{\pi}{4}$ describes this surface.  Therefore $D$ can be described as all points $\left( \rho, \theta,\varphi\right)$ with $0 \leq \rho \leq \cos\varphi$, $0 \leq \theta \leq 2\pi$, and $0 \leq \varphi \leq \frac{\pi}{4}$.  \\

Lastly, to integrate we need to write the integrand $x^2 + y^2 + z^2$ as $\rho^2$ and include the spherical integration factor $\rho^2 \: \sin\varphi$.  Therefore
\begin{eqnarray*}
\iiint_E x^2 + y^2 + z^2 \: dV & = & \int_0^{2\pi} \int_0^{\pi/4} \int_0^{\cos\varphi} \rho^4 \: \sin\varphi \: d\rho \: d\varphi \: d\theta \\
 & = & 2\pi \: \int_0^{\pi/4} \sin\varphi \left. \dfrac{1}{5} \rho^5 \right|_{0}^{\cos\varphi} \: d\varphi \\
 & = & \dfrac{2}{5}\pi \int_0^{\pi/4} \cos^5\varphi \sin\varphi \: d\varphi \\
 & = & \dfrac{2}{5}\pi \left(\left. -\dfrac{1}{6}\cos^6\varphi \right|_{0}^{\pi/4}\right) \\
 & = & \dfrac{2}{5}\pi \left( \dfrac{1}{8} - 1 \right) = \dfrac{7\pi}{120} \\
\end{eqnarray*}
}\\

\example{ex_spherical3}{Finding the center of mass using spherical coordinates}
{Find the center of mass of the solid with constant density enclosed above by $\rho=4$ and below by $\varphi = \pi/6$, as illustrated in Figure \ref{fig:spherical3}.
}
{We will set up the four triple integrals needed to find the center of mass (i.e., to compute $M$, $M_{yz}$, $M_{xz}$ and $M_{xy}$) and leave it to the reader to evaluate each integral. Because of symmetry, we expect the $x$- and $y$- coordinates of the center of mass to be 0.
\mfigurethree{width=150pt,3Dmenu,activate=onclick,deactivate=onclick,
3Droll=0,
3Dortho=0.004498619586229324,
3Dc2c=0.7278125882148743 0.6620227098464966 0.17892660200595856,
3Dcoo=-23.626569747924805 -17.348602294921875 60.14314270019531,
3Droo=150,
3Dlights=Headlamp,add3Djscript=asylabels.js}{width=150pt}{.35}{Graphing the solid, and its center of mass, from Example \ref{ex_spherical3}.}{fig:spherical3}{figures/figspherical3_3D} 

While the surfaces describing the solid are given in the statement of the problem, to describe the full solid $D$, we use the following bounds: $0 \leq \rho \leq 4$, $0 \leq \theta \leq 2\pi$ and $0 \leq \varphi \leq \pi/6$. Since density $\delta$ is constant, we assume $\delta =1$.

The mass of the solid:
\begin{align*}
M &= \iiint_D\ dm = \iiint_D\ dV\\
	&= \int_0^{\pi/6}\int_0^{2\pi}\int_0^4\big(\rho^2\sin(\varphi)\big)\ d\rho\ d\theta\ d\varphi\\
	&= \frac{64}3\big(2-\sqrt{3}\big)\pi \approx 17.958.
\end{align*}

To compute $M_{yz}$, the integrand is $x$; using Key Idea \ref{idea:cylcart_conversion}, we have $x = \rho\sin\varphi\cos\theta$. This gives:
%\drawexampleline
\begin{align*}
M_{yz} &= \iiint_D x\ dm \\
	&= \int_0^{\pi/6}\int_0^{2\pi}\int_0^4 \big((\rho\sin(\varphi)\cos(\theta))\rho^2\sin(\varphi)\big) \ d\rho\ d\theta\ d\varphi\\
	&= \int_0^{\pi/6}\int_0^{2\pi}\int_0^4 \big(\rho^3\sin^2(\varphi)\cos(\theta)\big) \ d\rho\ d\theta\ d\varphi\\
	&=0,
\end{align*}
which we expected as we expect $\overline{x} = 0$.

To compute $M_{xz}$, the integrand is $y$; using Key Idea \ref{idea:sphericalcart_conversion}, we have $y = \rho\sin\varphi\sin\theta$. This gives:
\begin{align*}
M_{xz} &= \iiint_D y\ dm \\
	&= \int_0^{\pi/6}\int_0^{2\pi}\int_0^4 \big((\rho\sin(\varphi)\sin(\theta))\rho^2\sin(\varphi)\big) \ d\rho\ d\theta\ d\varphi\\
	&= \int_0^{\pi/6}\int_0^{2\pi}\int_0^4 \big(\rho^3\sin^2(\varphi)\sin(\theta)\big) \ d\rho\ d\theta\ d\varphi\\
	&=0,
\end{align*}
which we also expected as we expect $\overline{y} = 0$.

To compute $M_{xy}$, the integrand is $z$; using Key Idea \ref{idea:sphericalcart_conversion}, we have $z = \rho\cos\varphi$. This gives:
\begin{align*}
M_{xy} &= \iiint_D z\ dm \\
	&= \int_0^{\pi/6}\int_0^{2\pi}\int_0^4 \big((\rho\cos(\varphi))\rho^2\sin(\varphi)\big) \ d\rho\ d\theta\ d\varphi\\
	&= \int_0^{\pi/6}\int_0^{2\pi}\int_0^4 \big(\rho^3\cos(\varphi)\sin(\varphi)\big) \ d\rho\ d\theta\ d\varphi\\
	&=16\pi \approx 50.266.
\end{align*}

Thus the center of mass is $(0,0,M_{xy}/M) \approx (0,0,2.799)$, as indicated in Figure \ref{fig:spherical3}. 
}\\

This section has provided a brief introduction into two new coordinate systems useful for identifying points in space. Each can be used to define a variety of surfaces in space beyond the canonical surfaces graphed as each system was introduced.

However, the usefulness of these coordinate systems does not lie in the variety of surfaces that they can describe nor the regions in space these surfaces may enclose. Rather,  cylindrical coordinates are mostly used to describe cylinders and spherical coordinates are mostly used to describe spheres. These shapes are of special interest in the sciences, especially in physics, and computations on/inside these shapes is difficult using rectangular coordinates. For instance, in the study of electricity and magnetism, one often studies the effects of an electrical current passing through a wire; that wire is essentially a cylinder, described well by cylindrical coordinates. \\

This chapter investigated the natural follow--on to partial derivatives: iterated integration. We learned how to use the bounds of a double integral to describe a region in the plane using both rectangular and polar coordinates, then later expanded to use the bounds of a triple integral to describe a region in space. We used double integrals to find volumes under surfaces, surface area, and the center of mass of lamina; we used triple integrals as an alternate method of finding volumes of space regions and also to find the center of mass of a region in space.

Integration does not stop here. We could continue to iterate our integrals, next investigating ``quadruple integrals'' whose bounds describe a region in 4--dimensional space (which are very hard to visualize). We can also look back to ``regular'' integration where we found the area under a curve in the plane. A natural analogue to this is finding the ``area under a curve,'' where the curve is in space, not in a plane. These are just two of many avenues to explore under the heading of ``integration.''

\printexercises{exercises/13_08_exercises}